Our prototype is built on top of the state-of-the-art genetic fuzzing framework AFL, which is a popular off-the-shelf fuzzer, and the S2E symbolic execution platform \cite{chipounov2011s2e}. S2E is a dynamic binary analysis platform which utilizes selective symbolic execution to analyze whole software stacks at runtime. So far, S2E is available for many instructions set architecture, such as X86, ARM and so on. S2E reuses parts of the QEMU virtual machine \cite{bellard2005qemu}, the KLEE symbolic execution engine \cite{cadar2008klee} and the LLVM toolchain \cite{lattner2004llvm}.

The mutation strategy of AFL was not changed obviously, and we only added some extra code to implement the distance based seed prioritization method. On the S2E side, we implemented three main plugins, namely \textit{BitmapSearcher}, \textit{SLBhandler} and \textit{LSPhandler}. The \textit{BitmapSearcher} is used to share internal information with AFL to generate test cases for the uncovered branches. The \textit{SLBhandler} focuses on symbolic loops and leverages SLB method to only generate test cases for specific loop times according to the loop buckets. The \textit{LSPhandler} implements the LSP algorithm to generate test cases for branches where state forking failures occur to improve the coverage.
